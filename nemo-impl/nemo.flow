import runtime;
import maybe;
import nemo_parser;
import nemo_translator;

testNemoParser(i: int, s: string, verbose: bool) -> Prog{
    example = getFileContent(s);
    println("TEST" + i2s(i) + ":" + s + ":");
    if(verbose){println(example)};
    // parsing
    p1 = parse(example);
    err = Prog([], nTest(Int(0)));
    p1sure = either(p1, err);
    println("   result:");
    if(p1sure == err){
        println("   Error:Parse");
    } else {
        if(verbose){
            println(p1sure);
        } else {
            println("   Success:Parse");
        }
    }
    //translating
    p2 = n2v(p1sure);
    println(p2);
    // println("   prog2s(Prog):");
    // println(prog2s(p1sure));
    p1sure;
}

main(){
    tests = ["example", "type", "test", "union", "long"];
    mapi(tests, \i, x -> testNemoParser(i, "./test/" + x + ".txt", false));
}